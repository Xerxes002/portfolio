<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Cybersecurity Homelab</title>
    <meta name="description" content="Case study page of Project" />

    <link rel="stylesheet" href="css/style.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700;900&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <header class="header">
      <div class="header__content">
        <div class="header__logo-container">
          <span class="header__logo-sub">Tristan Wartan</span>
        </div>
        <div class="header__main">
          <ul class="header__links">
            <li class="header__link-wrapper">
              <a href="./index.html" class="header__link"> Home </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#about" class="header__link">About </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#projects" class="header__link">
                Projects
              </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#contact" class="header__link"> Contact </a>
            </li>
          </ul>
          <div class="header__main-ham-menu-cont">
            <img
              src="./assets/svg/ham-menu.svg"
              alt="hamburger menu"
              class="header__main-ham-menu"
            />
            <img
              src="./assets/svg/ham-menu-close.svg"
              alt="hamburger menu close"
              class="header__main-ham-menu-close d-none"
            />
          </div>
        </div>
      </div>
      <div class="header__sm-menu">
        <div class="header__sm-menu-content">
          <ul class="header__sm-menu-links">
            <li class="header__sm-menu-link">
              <a href="./index.html"> Home </a>
            </li>

            <li class="header__sm-menu-link">
              <a href="./index.html#about"> About </a>
            </li>

            <li class="header__sm-menu-link">
              <a href="./index.html#projects"> Projects </a>
            </li>

            <li class="header__sm-menu-link">
              <a href="./index.html#contact"> Contact </a>
            </li>
          </ul>
        </div>
      </div>
    </header>
    <section class="project-cs-hero">
      <div class="project-cs-hero__content">
        <h1 class="heading-primary">Building a Cybersecurity Homelab</h1>
        <div class="project-cs-hero__info">
          <p class="text-primary">
            &nbsp 
          </p>
        </div>
        <div class="project-details__tools-used">
          <h3 class="project-details__content-title">Tools Used</h3>
          <div class="tools">
            <div class="tools__tool">pfSense</div>
            <div class="tools__tool">HyperV</div>
            <div class="tools__tool">VMware vSphere</div>
            <div class="tools__tool">Windows Server 2019</div>
            <div class="tools__tool">Windows 10 Enterprise</div>
            <div class="tools__tool">Security Onion</div>
            
          </div>

      </div>
    </section>
    <section class="project-details">
      <div class="main-container">
          <div class="project-details__content-main">
            <div class="project-details__desc">
              <br>
              <br>
              <!--"Table of Contents"-->
              <h3 class="project-details__content-title">
                Table of contents
              </h3>
              <ul class="table-of-contents">
                  <li class="toc-wrapper">
                    <a href="#Introduction">1. Introduction</a>
                  </li>
                  <li class="toc-wrapper">
                    <a href="#Materials_Used">2. Materials Used</a>
                  </li>
                  <li class="toc-wrapper">
                    <a href="#Creating_a_topology_diagram">3. Creating a topology diagram</a>
                  </li>
                  <li class="toc-wrapper">
                    <a href="#Installing_pfSense">4. Installing pfSense</a>
                  </li>
                  <li class="toc-wrapper">
                    <a href="#Installing_HyperV">5. Installing HyperV and Windows Server 2019</a>
                  </li>
                  <li class="toc-wrapper">
                    <a href="#Creating_client_VMs">6. Creating client VMs and joining them to the domain</a>
                  </li>
                  <li class="toc-wrapper">
                    <a href="#Installing_vSphere">7. Installing vSphere</a>
                  </li>
                  <li class="toc-wrapper">
                    <a href="#Installing_SO">8. Installing Security Onion</a>
                  </li>
                  <li class="toc-wrapper">
                    <a href="#Sending_network_traffic">9. Sending network traffic to Security Onion</a>
                  </li>
                  <li class="toc-wrapper">
                    <a href="#Installing_WinLogBeat">10. Sending event viewer logs to Security Onion using WinLogBeat</a>
                  </li>
                  <li class="toc-wrapper">
                    <a href="#Sending_pfsense_logs">11. Sending pfSense logs to Security Onion</a>
                  </li>
                  <li class="toc-wrapper">
                    <a href="#Conclusion">12. Conclusion</a>
                  </li>

                  
                </ul>
            </div>
            <div class="project-details__links">
              <h3 class="project-details__content-title">Introduction</h3>
              <a class="anchor" id="Introduction"></a>
              <p class="project-details__desc-para">
                In Cybersecurity, it can be difficult to implement security concepts without testing them first in a controlled environment where
                downtime is an option.
                
              </p>
              <p class="project-details__desc-para">
                With that in mind, I created this project to simulate an enterprise network that we can then monitor and test for vulnerabilities.
                This guide will walk through configuring, optimizing, and securing an I.T. environment for a small business. 
              </p>
            </div>
            <div class="project-details__links">
              <a class="anchor" id="Materials_Used"></a>
              <h3 class="project-details__content-title">Materials Used</h3>

                <ul class="material-list">
                  <li>-PC running pfSense (Core 2 Duo, 4gb Ram, 500gb HDD)</li>
                  <li>-PC running HyperV w/ Windows Server 2019 and 2x Windows 10 Machines (Ryzen 7 5800x, 3080ti, 64gb RAM, 2tb NVME SSD)</li>
                  <li>-PC running vSphere w/ Security Onion (i7 8700, 1080, 16gb RAM, 500gb NVME SSD)</li>
                  <li>-USB device</li>
                  <li>-Managed Switch w/ Span port</li>
                </ul>
              </p>
              
            <div class="project-details__links">
              <a class="anchor" id="Creating_a_topology_diagram"></a>
              <h3 class="project-details__content-title">
                Creating a topology diagram
              </h3>
              <p class="project-details__desc-para">
                To start, it is important to create a topology diagram of the network help outline what devices will be placed inside the network
                and how they will be connected to eachother. In my setup, I am using a dedicated computer for pfSense. However, I will be using 
                Hyper-V to host several Windows machines and vSphere to host Security Onion.
              </p>
              <div class="project-details__showcase-img-cont">
                <img
                  src="./assets/png/networkdiagram.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
            
            <div class="project-details__links">
              <a class="anchor" id="Installing_pfSense"></a>
              <h3 class="project-details__content-title">
                Installing pfSense
              </h3>
              <p class="project-details__desc-para">
                PfSense is a free router and firewall solution. This will be used to segment my home network and create a seperate subnet.
                In addition firewall rules will be created to increase the security of the network later on. Ensure that there are two interaces present
                on the computer. One will be used as a LAN interface and the other will be used as a WAN interface to allow internal devices to connect to
                the web.
              </p>
              <p class="project-details__desc-para">
                To start, downloaded the ISO image from pfSense's website and create a bootable USB using Rufus.
              </p>
              <div class="project-details__showcase-img-shrink">
                <img
                  src="./assets/png/rufus-pfsense.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
            </div>      
            <div class="project-details__links">
              <p class="project-details__desc-para">
                After creating the bootable USB, plug the USB stick into the machine that we will be installing pfSense on.
                Change the boot order in the computer's BIOS to boot from the USB stick.
                pfSense will now start it's installation setup.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/pfsense-installer.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Accept all defaults and select a drive to install pfSense to. Ensure that you have both a WAN and LAN IP address. The LAN IP will Server
                as the IP for management.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/pfsense-shell.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                This completes the basic configuration of pfSense. The rest of the configuration will be done later on
                in pfSense's configuration webpage.
              </p>
            <div class="project-details__links">
              <a class="anchor" id="Installing_HyperV"></a>
              <h3 class="project-details__content-title">Installing HyperV and Windows Server 2019</h3>
              <p class="project-details__desc-para">
                In an enterprise network, servers can be installed on a hypervisor. This allows for easier deployment and the ability
                to create snapshots. In our lab, we will be using Hyper-V to host Windows Server 2019 and additional Windows
                10 machines.
              </p>
              <p class="project-details__desc-para">
                To start, we will first need to install Hyper-V on the host machine. My host machine is running Windows 11 Pro. It is important to
                note that Hyper-V cannot be installed on Windows 10/11 Home. First, we need to ensure that Hyper-V is enabled in Windows Features.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windowsfeatures-hyperv.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Once Hyper-V is enabled, open Hyper-V by searching in the Windows menu, then click Hyper-V Manager.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-hyperv-manager.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                With the manager open, click New, then Virtual Machine in order to open the Virtual Machine Wizard. Provide a name for the virtual machine
                 (Windows Server 2019). Choose Generation 1, and provide atleast 4GB of memory (4096MB). For the connection select External Switch so that
                 the VM can communicate with computers outside of the Hyper-V Manager. Select "Create a virtual hard disk", then select "Install an operating
                 system from a bootable CD/DVD-ROM". Finally, we will need to select the Windows Server 2019 ISO installer. This can be found on Microsoft's
                 website where evaluation copies are provided. Click finish to create the virtual machine.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-hyperv-vmcreation.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Double click the newly created virtual machine to launch the VM connection. Click start to power it on. Once powered on you will see the
                the setup for Windows Server 2019.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-installer.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Click next, then click install. Select "Windows Server 2019 (Desktop Experience)", then click next. Select Custom, then select the hard
                disk and click next. Windows will begin installing Windows Server 2019. Once complete, the VM will restart. Create a password for the 
                built in administrator account and click finish.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-admin-password.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Once finished you should see this screen.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-manager.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Next we will rename the Server. Click the WIndows start search in the bottom left corner. Search for "workgroup" then click "Change
                workgroup name". Rename the PC to your choice name. Restart the VM for the change to take effect.
              </p>
              <div class="project-details__showcase-img-shrink">
                <img
                  src="./assets/png/windows-server-rename.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Open the server manager. Click manage, then "Add roles and features". 
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-manager-addroles.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Keep clicking next until you reach the Server Roles tab.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-manager-serverroles.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Select "Active Directory Domain Services". Click "Add Features". Click next until you reach the confirmation menu, then click install.
                Close the Window once the installation is complete.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-ad-installation.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Click the flag with the yellow hazard sign. Click "promote this server to a domain controller".
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-ad-postdeployment.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Select "Add a new forest" and specify a domain name. Click next. Set a DSRM password. Click next until the prerequisites check, then click install.
              </p>
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-ad-deploymentconfig.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>

              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-ad-installationstart.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Next, we will create some users inside our domain. Click the Windows start menu, then click "Windows Administrative Tools", then click
                "Active Directory Users and Computers". Right click your domain name on the left panel then click New > User. Enter the first and last
                name of the user and specify a login username and password.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-ad-newuser.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Create additional users as needed.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-ad-newuser2.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Next, we will create network shares that users can store files in. Open the server manager and click "File and Storage Services". Then
                click "Shares". 
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-file-storage-services.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Right click in the empty space below the NETLOGON and SYSVOL shares and click "New Share...". Select SMB Share - Quick and click next. Click next again.
                Enter a share name and description. Ensure proper permissions are given to users as needed. Click next and create the share.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-share-creation.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Create additional shares as needed.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-shares.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Next, we will disable the built in firewall since pfSense will function as the primary firewall. Open the start menu and search for Windows Defender Firewall.
                Open it and click "Turn Windows Defender Firewall on or off" on the left side of the window.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-disable-firewall.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                To finish configuration, we will need to set a static IP address and point the server to our pfSense gateway. Open the start menu and click Control Panel.
                Then click "Network and Internet" and "Network and Sharing Center". Click "Change adapter settings" and right click the Hyper-V Network adapter. Open
                the properties menu then select IPv4. Open the IPv4 properties and set a static IP and default gateway. The static IP should be something outside of pfSense's
                DHCP scope and the default gateway should be the IP address of pfSense.
              
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-server-set-static.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                This concludes the basic configuration for our server. Next we will create client VM's and join them to the domain we created.
              </p>
              <a class="anchor" id="Creating_client_VMs"></a>
              <h3 class="project-details__content-title">Creating client VMs and joining them to the domain</h3>
              <p class="project-details__desc-para">
                In this section we will install client VMs and join them to our domain. First, open Hyper-V manager on the host machine. We can use the
                quick create feature to create a VM running Windows 10 Enterprise.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-hyperv-quickcreate.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Ensure that the network is set to "External Switch" so that the machine can communicate with the rest of the network. Then click
                "Create Virtual Machine". Hyper-V will then automatically download the operating system and load it as a VM.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-hyperv-quickcreate2.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Once the VM is created, launch it by double clicking it inside the Hyper-V manager. Then click "Start". Next we will begin
                the Windows 10 setup.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-10-setup.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Click next until you reach the sign in page. Click "Domain join instead" in the bottom left. Then create a local account for administrative
                purposes.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-10-setup2.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Click next when prompted to create a password. We will be setting a password later in order to bypass the security questions. Turn off all
                privacy settings that click Accept. Once setup is complete you will see the login screen. Click Sign In.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-10-setup3.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                We will first change the password for the local admin account. Use Ctr + Alt + End to access the login options. Select change a password,
                then setup a password. Note: On a physical machine this will be Ctr + Alt + Del instead of End.
              </p>
              <div class="project-details__showcase-img-shrink">
                <img
                  src="./assets/png/windows-10-setup4.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Next we will change the DNS server. Open Control Panel and click View network status and tasks. Click change adapter settings on the left.
                Then open the Ethernet properties and go to IPv4 properties. Select "Use the following DNS server addresses" then enter the IP of the server
                we set up previously. Click OK to confirm.
              </p>
              <div class="project-details__showcase-img-shrink">
                <img
                  src="./assets/png/windows-10-setup5.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Next we will rename the PC. Open control panel and search "rename". Click "Rename this computer" to
                access the System Properties. First click Change at the bottom of the window and rename the computer. Then click OK to confirm the name.
                Restart the PC as requested.
              </p>
              <div class="project-details__showcase-img-shrink">
                <img
                  src="./assets/png/windows-10-setup6.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                At this point we will join the PC to the domain. Log back in after the restart and return to the System Properties. Click on Network ID.
                Select the first option and click next. Select My company uses a network with a domain. Click next. Enter the credentials for the admin domain
                account.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-10-setup7.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Enter the credentials of the domain admin account and click OK. Restart the computer as requested.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-10-setup8.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Now that the computer is on the domain, we now have the Other User option and can log into domain accounts. Click Other User and enter
                the credentials for the user who will be primarily using the computer.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-10-setup9.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                This concludes the setup for adding a Windows 10 machine to the domain. If you created any server shares those can be mapped at this point. Additional
                VMs can be created as needed.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-10-setup10.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/windows-10-setup11.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <a class="anchor" id="Installing_vSphere"></a>
              <h3 class="project-details__content-title">Installing vSphere</h3>
              <p class="project-details__desc-para">
                In this section we will setup the vSphere components, starting with ESXi. First grab the ESXi ISO from VMware's website.
                You will be required to make a VMware account in order to access the download page.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-iso-download.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Once downloaded we will use Rufus again in order to create a bootable USB.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-rufus.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                After the bootable USB is created, insert the USB drive into the computer we will be installing ESXi on. Once the computer
                boots you will see the ESXi setup screen.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-esxi-installation1.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Press enter to continue. Then press F11 to accept the TOS. Now configure a root password
                for the machine. Once finished you will be prompted to reboot the system. Press enter.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-esxi-installation2.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Upon reboot you will be asked for the root password. Once entered you will be shown a screen with the
                management interface. Copy that IP address and enter it into a web browser on a seperate PC. Log in
                using the credentials you set up previously. You will now be logged into the ESXI web interface.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-esxi-web-interface.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <a class="anchor" id="Installing_SO"></a>
              <h3 class="project-details__content-title">Installing Security Onion</h3>
              <p class="project-details__desc-para">
                Now that the hypervisor is set up. We will now install our Security Onion as virtual machine. Security Onion will
                function as our Security and Event Management System (SIEM). It will take capture logs and networking traffic and aggregate
                it in a way that is easy to search, manage, and visualize. Head over to https://github.com/Security-Onion-Solutions/securityonion/blob/master/VERIFY_ISO.md
                and download the ISO. Before we can upload the ISO to ESXi we first need to create a datastore. Right click "Storage" on the left panel menu and
                click "New Datastore".
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-esxi-create-datastore1.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Select "Create new VMFS datastore" and click next. Leave the default partioning options and click next. Finally, click finish to create the datastore.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-esxi-create-datastore2.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Open the newly created Datastore. Click "Datastore browser". 
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-esxi-create-datastore3.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Click upload and select the Security Onion ISO to upload it. Once uploaded it will appear in the datastore.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-esxi-create-datastore4.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Now we are ready to create the VM. Go to the Virtual Machines tab and click "Create/Register VM". The new virtual machine wizard
                will start. Select Create a new virtual machine and click next.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-esxi-create-vm1.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Enter a name for the virtual machine (ie. Security Onion). For the guest OS family select Linux and for the version
                select Ubuntu Linux (64-bit).
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-esxi-create-vm2.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Select the datastore we previously created then click next. Now we will allocate resources for the Security Onion VM. In my
                VM I am allocating 4 cores, 12GB RAM, and 200GB of Storage. We also will need to create an additional adapter. Click create
                virtual adapter and ensure there are two virtual adapters. Once done click next then click finish to create the VM.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-esxi-create-vm3.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>

              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-esxi-create-vm4.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-esxi-create-vm5.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Before we start the VM, we need to ensure the VM boots the Security Onion ISO. Open the VM page and click edit. Then CD/DVD Drive 1 change
                "Host Device" to "Datastore ISO File". Select the ISO from the datastore and click save.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/vsphere-esxi-create-vm6.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Click power on. Click the VM window to expand it. If the ISO successfully loads
                you will be greeted with the Security Onion Installer. Select the first option and click next.
                You will then have to create an administrator account. Once finished the computer will reboot.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation1.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Once rebooted login with account we created earlier. Now we will configure Security Onion. Select yes and press enter to continue.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation2.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Now we need to select the install type. Choose STANDALONE and press ok. Type agree to accept the license agreement and press ok to continue.
                Leave the default hostname and continue.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation3.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Now we will select the management NIC for Security Onion. Select the first option using spacebar then select ok to continue.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation4.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Select static and press continue. Now set a static IP to an IP address that is outside the DHCP scope.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation5.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation6.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Now enter the IP of the PfSense gateway.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation7.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                We will now add our DNS servers to Security Onion. 
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation8.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Now enter the domain we created previously on Windows Server.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation9.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Select standard and continue. Select Direct and press continue. 
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation10.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation11.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Add the second NIC to Security Onion.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation12.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Now enter the network using CIDR form.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation13.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Leave all the services on and continue.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation14.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Enter an email to be used to log into the dashboard. Enter a password and select ok to continue.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation15.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation16.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Select IP and continue. 
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation17.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Select no when asked to configure NTP servers.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation18.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Confirm the selected install options. Select yes and press enter to begin the installation.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation19.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Once installation is complete the machine will reboot.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-installation20.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Now we will log into the web interface. Open a web browser and go to the IP we assigned earlier.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-overview.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <a class="anchor" id="Sending_network_traffic"></a>
              <h3 class="project-details__content-title">Sending network traffic to Security Onion</h3>
              <p class="project-details__desc-para">
                At this point Security Onion is installed but we have no information feeding to it. First we will capture all network traffic leaving and entering our subnet. To do this
                we will mirror the port on our switch that is connected to our PfSense machine.
              </p>
              <p class="project-details__desc-para">
                First, we will ensure our ESXi settings are correct. We will need a virtual switch to connect both of Security Onion's virtual interfaces.
                Right click Networking on the left bar and select "Create a virtual switch". Name the switch Mirror, and ensure promiscuous mode is enabled.
                Lastly, we will connect our 2nd physical interface to this switch. Click add to finish.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/esxi-switch.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Next, create a port group by right clicking Networking and selecting "Create Port Group". Name the port group mirror and select the switch we just created. Then make sure the group
                is set to inherit security settings from the switch. Click add to finish.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/esxi-switch2.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Now we will begin mirroring traffic on our switch and send it to Security Onion. Go to the IP of your managed switch to access the web interface. 
                Now go to the port mirror settings on the switch. Select the port that the mirroring traffic will be sent to. Then select which port to capture traffic.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/tp-link-mirror.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                At this point Security Onion is recieving network traffic from our mirrored port. Log back into the web interface for Security Onion. Then click Kibana on the left bar under tools.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/security-onion-kibana1.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <div class="project-details__showcase-img-enlarge">
                <img
                  src="./assets/png/security-onion-kibana2.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Kibana is a tool which allows for visualization and filtering of logs. Scroll down and you will see network traffic being captured.
              </p>
              <div class="project-details__showcase-img-enlarge">
                <img
                  src="./assets/png/security-onion-kibana3.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                ElasticSearch is what is running under Kibana and allows us to filter logs. We can filter by destination ip/port, source ip/port, along with many other methods of filtering logs.
              </p>
              <div class="project-details__showcase-img-shrink">
                <img
                  src="./assets/png/security-onion-kibana4.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <a class="anchor" id="Installing_WinLogBeat"></a>
              <h3 class="project-details__content-title">Sending event viewer logs to Security Onion using WinLogBeat</h3>
              <p class="project-details__desc-para">
                In addition to capturing network traffic, we can use an agent to capture logs off of our Windows machines. To do this we will be using WinLogBeat to capture event viewer logs.
                First go to the main Security Onion web interface and click downloads on the left. Then click WinLogBeat to download the agent.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/winlogbeat1.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Now open the Windows Server VM and transfer the agent. Then open the installer and click install.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/winlogbeat2.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Open the example yml file with notepad. Ensure System and Security logs are being recorded, and add the IP of the Security Onion machine under
                output.logstash. Once finished save the file with the name "winlogbeat.yml".
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/winlogbeat4.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/winlogbeat9.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>

              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/winlogbeat5.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Now start the WinLogBeat service. Ensure that the service is running.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/winlogbeat6.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/winlogbeat8.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                At this point WinLogBeat is sending event viewer logs to our Security Onion machine. But we have not given permission for Security Onion to parse the logs.
                Open the terminal for Security Onion and type sudo so-allow. Then Select b for Logstash beat, and enable the subnet containing the Windows VMs.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/so-allow-logstash.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Now we are ready to view the logs in Security Onion. Open Kibana and click on hosts. Look for the newly added server.
              </p>
              <div class="project-details__showcase-img-rufus-pfsense">
                <img
                  src="./assets/png/winlogbeat10.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                head over to the Discover tab on the left bar. We can search specific event IDs through Kibana.
              </p>
              <div class="project-details__showcase-img-enlarge">
                <img
                  src="./assets/png/winlogbeat11.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Event code 4624 will show successful logons. Type event.code: 4624 in the search bar at the top and press enter.
              </p>
              <div class="project-details__showcase-img-enlarge">
                <img
                  src="./assets/png/winlogbeat12.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Searching by event code allows for easily finding specific events. Using filters we can also see when domain users are created, failed login attempts, and other security events.
              </p>
              <a class="anchor" id="Sending_pfsense_logs"></a>
              <h3 class="project-details__content-title">Sending pfSense logs to Security Onion</h3>
              <p class="project-details__desc-para">
                Now we will send pfSense logs to Security Onion. Log into the pfSense's web interface and navigate to Status > System Logs. 
              </p>
              <div class="project-details__showcase-img-enlarge">
                <img
                  src="./assets/png/pfsense-logs1.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Click on settings.
              </p>
              <div class="project-details__showcase-img-enlarge">
                <img
                  src="./assets/png/pfsense-logs2.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Scroll to the bottom and click the checkbox to enable remote logging. Under remote log servers, type in the IP of our Security Onion machine using port 514. Lastly we will specify which types of logs
                will be sent. In my case I will be sending Firewall Events. Click save to finish.
              </p>
              <div class="project-details__showcase-img-enlarge">
                <img
                  src="./assets/png/pfsense-logs3.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                Now we need to these logs to be parsed by Security Onion. Return to the Security Onion shell and type sudo so-allow. Then select s for syslog device and type in the IP of our pfSense machine. 
              </p>
              <div class="project-details__showcase-img-enlarge">
                <img
                  src="./assets/png/pfsense-logs4.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                At this point we can verify logs are being recieved by logging back into Kibana and clicking pfSense under Security Onion - Modules. 
              </p>
              <div class="project-details__showcase-img-enlarge">
                <img
                  src="./assets/png/pfsense-logs6.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <div class="project-details__showcase-img-enlarge">
                <img
                  src="./assets/png/pfsense-logs5.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>
              <p class="project-details__desc-para">
                As we can see, Security Onion is recieving the pfSense syslogs for firewall events. We can easily filter by IP or other parameters.
              </p>
              <div class="project-details__showcase-img-enlarge">
                <img
                  src="./assets/png/pfsense-logs7.png"
                  alt="Project Image"
                  class="project-details__showcase-img"
                />
              </div>



              <a class="anchor" id="Conclusion"></a>
              <h3 class="project-details__content-title">Conclusion</h3>
              <p class="project-details__desc-para">
                This concludes the lab. By building a homelab using enterprise tools we have set ourselves up for future labs where we will test vulnerabilities and perform incident response by implementing security measures.

              </p>


            </div>
          </div>
        </div>
      </div>
    </section>
    <footer class="main-footer">
      <div class="main-container">
        <div class="main-footer__upper">
          <div class="main-footer__row main-footer__row-1">
            <h2 class="heading heading-sm main-footer__heading-sm">
              <span>Social</span>
            </h2>
            <div class="main-footer__social-cont">
              <a target="_blank" rel="noreferrer" href="#">
                <img
                  class="main-footer__icon"
                  src="./assets/png/linkedin-ico.png"
                  alt="icon"
                />
              </a>
              <a target="_blank" rel="noreferrer" href="#">
                <img
                  class="main-footer__icon"
                  src="./assets/png/github-ico.png"
                  alt="icon"
                />
              </a>
              <a target="_blank" rel="noreferrer" href="#">
                <img
                  class="main-footer__icon"
                  src="./assets/png/twitter-ico.png"
                  alt="icon"
                />
              </a>
              <a target="_blank" rel="noreferrer" href="#">
                <img
                  class="main-footer__icon"
                  src="./assets/png/yt-ico.png"
                  alt="icon"
                />
              </a>
              <a target="_blank" rel="noreferrer" href="#">
                <img
                  class="main-footer__icon main-footer__icon--mr-none"
                  src="./assets/png/insta-ico.png"
                  alt="icon"
                />
              </a>
            </div>
          </div>
          <div class="main-footer__row main-footer__row-2">
            <h4 class="heading heading-sm text-lt">Tristan Wartan</h4>
            <!--p class="main-footer__short-desc">
              Lorem ipsum dolor sit amet but consectetur adipisicing elit facilis
              tempora explicabo quae quod deserunt
            </p-->
          </div>
        </div>

        <div class="main-footer__lower">
          &copy; Copyright 2022. Made by
          <!--a rel="noreferrer" target="_blank" href="https://rammaheshwari.com"-->
            Tristan Wartan.</a
          >
        </div>
      </div>
    </footer>
    <script src="./index.js"></script>
  </body>
</html>
